
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>FullwaveQC Documentation &#8212; FullwaveQC 1.0.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="module-fullwaveqc.tools">
<span id="fullwaveqc-documentation"></span><h1>FullwaveQC Documentation<a class="headerlink" href="#module-fullwaveqc.tools" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="fullwaveqc.tools.Model">
<em class="property">class </em><code class="sig-prename descclassname">fullwaveqc.tools.</code><code class="sig-name descname">Model</code><span class="sig-paren">(</span><em class="sig-param">filepath</em>, <em class="sig-param">name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fullwaveqc.tools.Model" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to store properties of SEG-Y 2D model files. Should be called only by the fullwaveqc.tools.load function.</p>
</dd></dl>

<dl class="class">
<dt id="fullwaveqc.tools.SegyData">
<em class="property">class </em><code class="sig-prename descclassname">fullwaveqc.tools.</code><code class="sig-name descname">SegyData</code><span class="sig-paren">(</span><em class="sig-param">filepath</em>, <em class="sig-param">name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fullwaveqc.tools.SegyData" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to store properties of SEG-Y data files. Should be called only by the fullwaveqc.tools.load function.</p>
</dd></dl>

<dl class="function">
<dt id="fullwaveqc.tools.ampnorm">
<code class="sig-prename descclassname">fullwaveqc.tools.</code><code class="sig-name descname">ampnorm</code><span class="sig-paren">(</span><em class="sig-param">Obs</em>, <em class="sig-param">Pred</em>, <em class="sig-param">ref_trace=0</em>, <em class="sig-param">verbose=1</em><span class="sig-paren">)</span><a class="headerlink" href="#fullwaveqc.tools.ampnorm" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalises the amplitude of a predicted dataset with an observed dataset by matching the values of their maximum
amplitudes of a reference trace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Obs</strong> (<a class="reference internal" href="#fullwaveqc.tools.SegyData" title="fullwaveqc.tools.SegyData"><em>fullwaveqc.tools.SegyData</em></a>) – Object outputted from fullwaveqc.tools.load function for the observed data</p></li>
<li><p><strong>Pred</strong> (<a class="reference internal" href="#fullwaveqc.tools.SegyData" title="fullwaveqc.tools.SegyData"><em>fullwaveqc.tools.SegyData</em></a>) – object outputted from fullwaveqc.tools.load function for the predicted data.
Requires same number of samples, sampling interval, shots and receiver positions
as Obs</p></li>
<li><p><strong>ref_trace</strong> (<em>int</em><em>, </em><em>optional</em>) – Trace number to normalise each shot. For streamer data, this value should be
0 in order to normalise the shot to the first arrival of the first trace. Default 0</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set to true to verbose the steps of this function. Default 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>PredNorm</strong> – Object outputted from fullwaveqc.tools.load function with the normalise predicted data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#fullwaveqc.tools.SegyData" title="fullwaveqc.tools.SegyData">fullwaveqc.tools.SegyData</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="fullwaveqc.tools.bandpass">
<code class="sig-prename descclassname">fullwaveqc.tools.</code><code class="sig-name descname">bandpass</code><span class="sig-paren">(</span><em class="sig-param">trace</em>, <em class="sig-param">flow</em>, <em class="sig-param">fhigh</em>, <em class="sig-param">forder</em>, <em class="sig-param">dt</em><span class="sig-paren">)</span><a class="headerlink" href="#fullwaveqc.tools.bandpass" title="Permalink to this definition">¶</a></dt>
<dd><p>Band passes a trace using a Butter filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trace</strong> (<em>numpy.array</em>) – 1D array containing the signal in time domain</p></li>
<li><p><strong>flow</strong> (<em>float</em>) – Low frquency to band pass (Hz)</p></li>
<li><p><strong>fhigh</strong> (<em>float</em>) – High frquency to band pass (Hz)</p></li>
<li><p><strong>forder</strong> (<em>float</em>) – Order of band pass filter, determines the steepnes of the transition band</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – Time sampling of the signal</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>filtered</strong> – 1D array of same size as trace, with the filtered signal</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="fullwaveqc.tools.ddwi">
<code class="sig-prename descclassname">fullwaveqc.tools.</code><code class="sig-name descname">ddwi</code><span class="sig-paren">(</span><em class="sig-param">MonObs</em>, <em class="sig-param">BaseObs</em>, <em class="sig-param">BasePred</em>, <em class="sig-param">normalise=True</em>, <em class="sig-param">name=None</em>, <em class="sig-param">mon_filepath=None</em>, <em class="sig-param">save=False</em>, <em class="sig-param">save_path='./'</em>, <em class="sig-param">verbose=1</em><span class="sig-paren">)</span><a class="headerlink" href="#fullwaveqc.tools.ddwi" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the monitor dataset used as the observed dataset for the Double Difference Waveform Inversion.
The DDWI monitor dataset is given by: u_mon = d_mon - d_base + u_base
Where d_mon and d_base are the observed monitor and baseline datasets, respectively, and u_base is the dataset from
a predicted baseline inversion model.
Note: If data delay has been applied to BaseObs and MonObs, the resulting ddwi dataset will already have the data
delay applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>MonObs</strong> (<a class="reference internal" href="#fullwaveqc.tools.SegyData" title="fullwaveqc.tools.SegyData"><em>fullwaveqc.tools.SegyData</em></a>) – Object outputted from fullwaveqc.tools.load function for the true monitor data</p></li>
<li><p><strong>BaseObs</strong> (<a class="reference internal" href="#fullwaveqc.tools.SegyData" title="fullwaveqc.tools.SegyData"><em>fullwaveqc.tools.SegyData</em></a>) – Object outputted from fullwaveqc.tools.load function for the true baseline data.
Requires same number of samples, sampling interval, shots and receiver position
as MonObs</p></li>
<li><p><strong>BasePred</strong> (<a class="reference internal" href="#fullwaveqc.tools.SegyData" title="fullwaveqc.tools.SegyData"><em>fullwaveqc.tools.SegyData</em></a>) – Object outputted from fullwaveqc.tools.load function for the predicted baseline data.
Requires same number of samples, sampling interval, shots and receiver position
as MonObs</p></li>
<li><p><strong>normalise</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true will normalise the amplitude of the predicted baseline dataset to match
the first trace of the observed dataset. Does so shot by shot. Default True</p></li>
<li><p><strong>name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name to give the DDWI dataset, if None will give the name “DDWI-DATASET”.
Default None</p></li>
<li><p><strong>mon_filepath</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to the observed monitor dataset. Must end in .sgy. Required if save option
is set to True. Default None.</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set to true if the DDWI dataset is to be saved in .sgy format. Default False</p></li>
<li><p><strong>save_path</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to folder where DDWI must be saved. Default “./”</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set to true in order to verbose the steps of this function. Default 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>MonDiff</strong> – Object outputted from fullwaveqc.tools.load function with the DDWI monitor data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#fullwaveqc.tools.SegyData" title="fullwaveqc.tools.SegyData">fullwaveqc.tools.SegyData</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>mon_filepath must be given if save is set to True. Saving occurs by copying and modifying
the monitor SEG-Y headers and traces.</p>
</dd></dl>

<dl class="function">
<dt id="fullwaveqc.tools.load">
<code class="sig-prename descclassname">fullwaveqc.tools.</code><code class="sig-name descname">load</code><span class="sig-paren">(</span><em class="sig-param">filepath</em>, <em class="sig-param">model</em>, <em class="sig-param">name=None</em>, <em class="sig-param">scale=1</em>, <em class="sig-param">verbose=1</em><span class="sig-paren">)</span><a class="headerlink" href="#fullwaveqc.tools.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a SEG-Y file into a SegyData or Model class, used for the other functionalities of the fullwaveqc package.
Accepts 2D segy files and of the same sampling interval for all shots and segy model files with square cells.
It is HIGHLY recommended that the attributes of this function are checked manually after loading, as different
SEG-Y header formats are likely to be loaded incorrectly. This function is adapted to the SEGY header format of
the outputs of Fullwave3D.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> (<em>str</em>) – Path to segy file. Must end in .sgy</p></li>
<li><p><strong>model</strong> (<em>bool</em>) – Set true to load a Model and false to load a SegyData object</p></li>
<li><p><strong>name</strong> (<em>str</em><em>, </em><em>optional</em>) – Name to give the data/model object. If None is given, name is inferred from .sgy file. Default is None</p></li>
<li><p><strong>scale</strong> (<em>int</em><em>, </em><em>optional</em>) – Value to multiply the data content of the files. Default 1</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set to true in order to verbose the steps of this loading function. Default True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>segy or model</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#fullwaveqc.tools.SegyData" title="fullwaveqc.tools.SegyData">fullwaveqc.tools.SegyData</a> or <a class="reference internal" href="#fullwaveqc.tools.Model" title="fullwaveqc.tools.Model">fullwaveqc.tools.Model</a>, depending on parameter model given</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="fullwaveqc.tools.rm_empty_traces">
<code class="sig-prename descclassname">fullwaveqc.tools.</code><code class="sig-name descname">rm_empty_traces</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">scale=1</em>, <em class="sig-param">verbose=1</em><span class="sig-paren">)</span><a class="headerlink" href="#fullwaveqc.tools.rm_empty_traces" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes all-zero traces of a SEG-Y file and saves the copy of the clean file in the same directory</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – Path to SEG-Y file, must end in .sgy</p></li>
<li><p><strong>scale</strong> (<em>int</em><em>, </em><em>optional</em>) – Value to multiply the data content of the files. Default 1</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set to true in order to verbose the steps of this loading function. Default True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="fullwaveqc.tools.set_verbose">
<code class="sig-prename descclassname">fullwaveqc.tools.</code><code class="sig-name descname">set_verbose</code><span class="sig-paren">(</span><em class="sig-param">verbose</em><span class="sig-paren">)</span><a class="headerlink" href="#fullwaveqc.tools.set_verbose" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to set the verbose print level
:param verbose: Verbose level, set to true to display verbose
:type verbose: bool</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>verbose_print(message)</strong> – Function to display verbose message in console</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>lamda function</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="fullwaveqc.tools.smooth_model">
<code class="sig-prename descclassname">fullwaveqc.tools.</code><code class="sig-name descname">smooth_model</code><span class="sig-paren">(</span><em class="sig-param">Model, strength=[1, 1], w=[None, None, None, None], slowness=True, name=None, save=False, save_path='./', verbose=1</em><span class="sig-paren">)</span><a class="headerlink" href="#fullwaveqc.tools.smooth_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Smoothes a model using scipy’s gaussian filter in “reflect” mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Model</strong> (<a class="reference internal" href="#fullwaveqc.tools.Model" title="fullwaveqc.tools.Model"><em>fullwaveqc.tools.Model</em></a>) – Object outputted from fullwaveqc.tools.load function for a model. Must have a valid filepath attribute.</p></li>
<li><p><strong>strength</strong> (<em>list</em><em>[</em><em>floats</em><em>]</em><em>, </em><em>optional</em>) – [horizontal_smoothing_factor, vertical_smoothing_factor]. Default [1,1]</p></li>
<li><p><strong>w</strong> (<em>list</em><em>[</em><em>ints</em><em>]</em><em>, </em><em>optional</em>) – Windowing of the smoothing. Smoothing will be applied to the internal window created by the rectangle determined
by [cells_from_top, cells_from bottom, cells_from_left, cells_from_right]. If None is given, then either the be
ginning or end will of the model will be used. Default [None, None, None, None]</p></li>
<li><p><strong>slowness</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True will smooth the slowness instead of velocities. Slowness defined
as the reciprocal value of velocity and is commonly preferred in smoothing. Default True</p></li>
<li><p><strong>name</strong> (<em>str</em><em>, </em><em>optional</em>) – name of the new smoothed model. If None it will be inferred from Model.
Default None</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set to true in order to save the model in .sgy format. Requires that Model
has a valid filepath attribute. Default False</p></li>
<li><p><strong>save_path</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to save the .sgy smoothed model. Default “./”</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>SmoothModel</strong> – Object as outputted from fullwaveqc.tools.load function containing the smoothed model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#fullwaveqc.tools.Model" title="fullwaveqc.tools.Model">fullwaveqc.tools.Model</a></p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-fullwaveqc.geom"></span><dl class="function">
<dt id="fullwaveqc.geom.boundarycalc">
<code class="sig-prename descclassname">fullwaveqc.geom.</code><code class="sig-name descname">boundarycalc</code><span class="sig-paren">(</span><em class="sig-param">d</em>, <em class="sig-param">dx</em>, <em class="sig-param">fmin</em>, <em class="sig-param">vmax</em><span class="sig-paren">)</span><a class="headerlink" href="#fullwaveqc.geom.boundarycalc" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the number of absorbing boundaries and number of cells from the source recommended for
a Fullwave run without reflections and interferences. Number of absorbing boundaries computed as
to guarantee it covers two of the largest wavelengths. Distance from source computed to guarantee
one Fresnel zone between the source and the first receiver. The total number of padding cells above
the source should therefore be nabsorb + ndist.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>float</em>) – distance between source and first receiver in units of distance (meters)</p></li>
<li><p><strong>dx</strong> (<em>float</em>) – size of model cell in units of distance (meters)</p></li>
<li><p><strong>fmin</strong> (<em>float</em>) – minimum frequency present in the wavelet (Hz)</p></li>
<li><p><strong>vmax</strong> (<em>float</em>) – maximum P-wave velocity expected from the models (m/s)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>nabsorb</strong> (<em>int</em>) – number of absorbing boundary cells recommended for the specific problem</p></li>
<li><p><strong>ndist</strong> (<em>int</em>) – number of padded cells from the source to the start of the absorbing boundaries</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="fullwaveqc.geom.surveygeom">
<code class="sig-prename descclassname">fullwaveqc.geom.</code><code class="sig-name descname">surveygeom</code><span class="sig-paren">(</span><em class="sig-param">rcvgeopath</em>, <em class="sig-param">srcgeopath</em>, <em class="sig-param">src_list=[]</em>, <em class="sig-param">plot=False</em>, <em class="sig-param">verbose=0</em><span class="sig-paren">)</span><a class="headerlink" href="#fullwaveqc.geom.surveygeom" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves and plots the in-line positions of the survey array as understood from SegyPrep.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rcvgeopath</strong> (<em>str</em>) – path to file &lt;PROJECT_NAME&gt;-Receivers.geo generated by SegyPrep</p></li>
<li><p><strong>srcgeopath</strong> (<em>str</em>) – path to file &lt;PROJECT_NAME&gt;-Sources.geo generated by SegyPrep</p></li>
<li><p><strong>src_list</strong> (<em>list</em><em>, </em><em>optional</em>) – list of source/shot numbers to retrieve and plot. Empty list returns all positions. Default: []</p></li>
<li><p><strong>plot</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true will plot the shots and receivers of src_list. Default:False</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true will print to console the steps of this function. Default: False</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul>
<li><p><strong>src_ret</strong> (<em>list</em>) – list of all in-line positions from the sources in src_list</p></li>
<li><p><strong>rcv_ret</strong> (<em>list</em>) –</p>
<dl class="simple">
<dt>list of numpy.arrays, for each source in src_list, with its array of in-line</dt><dd><p>receiver positions</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-fullwaveqc.visual"></span><dl class="function">
<dt id="fullwaveqc.visual.amplitude">
<code class="sig-prename descclassname">fullwaveqc.visual.</code><code class="sig-name descname">amplitude</code><span class="sig-paren">(</span><em class="sig-param">SegyData</em>, <em class="sig-param">shot=1</em>, <em class="sig-param">cap=0.0</em>, <em class="sig-param">levels=50</em>, <em class="sig-param">vmin=None</em>, <em class="sig-param">vmax=None</em>, <em class="sig-param">cmap=&lt;matplotlib.colors.LinearSegmentedColormap object&gt;</em>, <em class="sig-param">xstart=0</em>, <em class="sig-param">xend=None</em>, <em class="sig-param">wstart=0</em>, <em class="sig-param">wend=None</em>, <em class="sig-param">save=False</em>, <em class="sig-param">save_path='./'</em><span class="sig-paren">)</span><a class="headerlink" href="#fullwaveqc.visual.amplitude" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the amplitude map of a SegyData object in timesamples (dt units) vs receiver index.
Uses properties of matplotlib.contourf.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>SegyData</strong> (<a class="reference internal" href="#fullwaveqc.tools.SegyData" title="fullwaveqc.tools.SegyData"><em>fullwaveqc.tools.SegyData</em></a>) – object outputted from fullwaveqc.tools.load function for the segy data</p></li>
<li><p><strong>shot</strong> (<em>int</em><em>, </em><em>optional</em>) – shot number to visualise. Count starts from 1. Default 1</p></li>
<li><p><strong>cap</strong> (<em>float</em><em>, </em><em>optional</em>) – absolute value of amplitudes to cap, shown as 0. See matplotlib.pyplot.contourf parameters. Default 0</p></li>
<li><p><strong>levels</strong> (<em>int</em><em>, </em><em>optional</em>) – amount of levels in the contour plot. See matplotlib.pyplot.contourf parameters. Default 50</p></li>
<li><p><strong>vmin</strong> (<em>float</em><em>, </em><em>optional</em>) – min val of color plot scale. See matplotlib.pyplot.contourf parameters. Default None.</p></li>
<li><p><strong>vmax</strong> (<em>float</em><em>, </em><em>optional</em>) – max val of color plot scale. See matplotlib.pyplot.contourf parameters. Default None.</p></li>
<li><p><strong>cmap</strong> (<em>matplotlib.pyplot.cm</em>) – colormap. Default plt.cm.seismic</p></li>
<li><p><strong>xstart</strong> (<em>int</em><em>, </em><em>optional</em>) – first receiver index to plot. Default 0.</p></li>
<li><p><strong>xend</strong> (<em>int</em><em>, </em><em>optional</em>) – last receiver index to plot. Default None</p></li>
<li><p><strong>wstart</strong> (<em>int</em><em>, </em><em>optional</em>) – first timesample in time units to plot. Default 0</p></li>
<li><p><strong>wend</strong> (<em>int</em><em>, </em><em>optional</em>) – last timesample in time units to plot. Default None</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>) – set to true in order to save the plot in png 300dpi. Default False</p></li>
<li><p><strong>save_path</strong> (<em>str</em><em>, </em><em>optional</em>) – path to save the plot. Default “./”</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="fullwaveqc.visual.animateinv">
<code class="sig-prename descclassname">fullwaveqc.visual.</code><code class="sig-name descname">animateinv</code><span class="sig-paren">(</span><em class="sig-param">it_max</em>, <em class="sig-param">path</em>, <em class="sig-param">project_name</em>, <em class="sig-param">vmin=None</em>, <em class="sig-param">vmax=None</em>, <em class="sig-param">cmap=&lt;matplotlib.colors.LinearSegmentedColormap object&gt;</em>, <em class="sig-param">save=False</em>, <em class="sig-param">save_path='./'</em>, <em class="sig-param">verbose=0</em><span class="sig-paren">)</span><a class="headerlink" href="#fullwaveqc.visual.animateinv" title="Permalink to this definition">¶</a></dt>
<dd><p>Animates the evolution of an inversion progression outputted by Fullwave3D. Files searched for must be named:
&lt;project_name&gt;-CPxxxxx-Vp.sgy and be all located in the same path folder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>it_max</strong> (<em>int</em>) – max amount of iterations to be animated</p></li>
<li><p><strong>path</strong> (<em>str</em>) – path to folder where .sgy model files are located</p></li>
<li><p><strong>project_name</strong> (<em>str</em>) – name of the project – must match exactly</p></li>
<li><p><strong>vmin</strong> (<em>float</em><em>, </em><em>optional</em>) – min val of color plot scale. See matplotlib.pyplot.contourf parameters. Default None.</p></li>
<li><p><strong>vmax</strong> (<em>float</em><em>, </em><em>optional</em>) – max val of color plot scale. See matplotlib.pyplot.contourf parameters. Default None.</p></li>
<li><p><strong>cmap</strong> (<em>matplotlib.pyplot.cm</em>) – colormap. Default plt.cm.jet</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>) – set to true in order to save the animation. Default False</p></li>
<li><p><strong>save_path</strong> (<em>str</em><em>, </em><em>optional</em>) – path to save the plot. Default “./”</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – If set to True will verbose the main steps of the function calculation. Default True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="fullwaveqc.visual.interamp">
<code class="sig-prename descclassname">fullwaveqc.visual.</code><code class="sig-name descname">interamp</code><span class="sig-paren">(</span><em class="sig-param">SegyData1</em>, <em class="sig-param">SegyData2</em>, <em class="sig-param">shot=1</em>, <em class="sig-param">shot2=None</em>, <em class="sig-param">n_blocks=2</em>, <em class="sig-param">cap=0.0</em>, <em class="sig-param">levels=50</em>, <em class="sig-param">vmin=None</em>, <em class="sig-param">vmax=None</em>, <em class="sig-param">cmap=&lt;matplotlib.colors.LinearSegmentedColormap object&gt;</em>, <em class="sig-param">wstart=0</em>, <em class="sig-param">wend=None</em>, <em class="sig-param">xstart=0</em>, <em class="sig-param">xend=None</em>, <em class="sig-param">save=False</em>, <em class="sig-param">save_path='./'</em><span class="sig-paren">)</span><a class="headerlink" href="#fullwaveqc.visual.interamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the interleaving amplitude map of a SegyData1 and SegyData2 objects in timesamples vs receiver index.
Uses properties of matplotlib.contourf.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>SegyData1</strong> (<a class="reference internal" href="#fullwaveqc.tools.SegyData" title="fullwaveqc.tools.SegyData"><em>fullwaveqc.tools.SegyData</em></a>) – object outputted from fullwaveqc.tools.load function for the segy data</p></li>
<li><p><strong>SegyData2</strong> (<a class="reference internal" href="#fullwaveqc.tools.SegyData" title="fullwaveqc.tools.SegyData"><em>fullwaveqc.tools.SegyData</em></a>) – object outputted from fullwaveqc.tools.load function for the segy data
Requires same number of samples, sampling interval, shots and receiver
positions as SegyData1</p></li>
<li><p><strong>shot</strong> (<em>int</em><em>, </em><em>optional</em>) – shot number to visualise SegyData1. Count starts from 1. Default 1</p></li>
<li><p><strong>shot2</strong> (<em>int</em><em>, </em><em>optional</em>) – shot number to visualise SegyData2. Count starts from 1. If None, will .
be read the same as ‘shot’. Default None</p></li>
<li><p><strong>n_blocks</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of total blocks in the interleaving space</p></li>
<li><p><strong>levels</strong> (<em>int</em><em>, </em><em>optional</em>) – amount of levels in the contour plot. See matplotlib.pyplot.contourf parameters. Default 50</p></li>
<li><p><strong>cap</strong> (<em>float</em><em>, </em><em>optional</em>) – absolute value of amplitudes to cap, shown as 0. Default 0.</p></li>
<li><p><strong>vmin</strong> (<em>float</em><em>, </em><em>optional</em>) – min val of color plot scale. See matplotlib.pyplot.contourf parameters. Default None.</p></li>
<li><p><strong>vmax</strong> (<em>float</em><em>, </em><em>optional</em>) – max val of color plot scale. See matplotlib.pyplot.contourf parameters. Default None.</p></li>
<li><p><strong>cmap</strong> (<em>matplotlib.pyplot.cm</em>) – colormap. Default plt.cm.seismic</p></li>
<li><p><strong>xstart</strong> (<em>int</em><em>, </em><em>optional</em>) – first receiver index to plot. Default 0.</p></li>
<li><p><strong>xend</strong> (<em>int</em><em>, </em><em>optional</em>) – last receiver index to plot. Default None</p></li>
<li><p><strong>wstart</strong> (<em>int</em><em>, </em><em>optional</em>) – first timesample in time units to plot. Default 0</p></li>
<li><p><strong>wend</strong> (<em>int</em><em>, </em><em>optional</em>) – last timesample in time units to plot. Default None</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>) – set to true in order to save the plot in png 300dpi. Default False</p></li>
<li><p><strong>save_path</strong> (<em>str</em><em>, </em><em>optional</em>) – path to save the plot. Default “./”</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="fullwaveqc.visual.interwiggle">
<code class="sig-prename descclassname">fullwaveqc.visual.</code><code class="sig-name descname">interwiggle</code><span class="sig-paren">(</span><em class="sig-param">SegyData1</em>, <em class="sig-param">SegyData2</em>, <em class="sig-param">shot=1</em>, <em class="sig-param">shot2=None</em>, <em class="sig-param">overlay=0</em>, <em class="sig-param">scale=5</em>, <em class="sig-param">skip_trace=20</em>, <em class="sig-param">skip_time=0</em>, <em class="sig-param">delay_samples=0</em>, <em class="sig-param">wstart=0</em>, <em class="sig-param">wend=None</em>, <em class="sig-param">xstart=0</em>, <em class="sig-param">xend=None</em>, <em class="sig-param">label1='SegyData1'</em>, <em class="sig-param">label2='SegyData2'</em>, <em class="sig-param">save=False</em>, <em class="sig-param">save_path='./'</em><span class="sig-paren">)</span><a class="headerlink" href="#fullwaveqc.visual.interwiggle" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the interleaving wiggle trace map of a SegyData1 and SegyData2 objects in timesamples vs receiver index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>SegyData1</strong> (<a class="reference internal" href="#fullwaveqc.tools.SegyData" title="fullwaveqc.tools.SegyData"><em>fullwaveqc.tools.SegyData</em></a>) – object outputted from fullwaveqc.tools.load function for the segy data</p></li>
<li><p><strong>SegyData2</strong> (<a class="reference internal" href="#fullwaveqc.tools.SegyData" title="fullwaveqc.tools.SegyData"><em>fullwaveqc.tools.SegyData</em></a>) – object outputted from fullwaveqc.tools.load function for the segy data
Requires same number of samples, sampling interval, shots and receiver
positions as SegyData1</p></li>
<li><p><strong>shot</strong> (<em>int</em><em>, </em><em>optional</em>) – shot number to visualise SegyData1. Count starts from 1. Default 1</p></li>
<li><p><strong>shot2</strong> (<em>int</em><em>, </em><em>optional</em>) – shot number to visualise SegyData2. Count starts from 1. If None, will
be read the same as ‘shot’. Default None</p></li>
<li><p><strong>overlay</strong> (<em>int</em><em>, </em><em>optional</em>) – If +ve, traces will be overlaid in different colours instead of being
displayed side by side. Overlay=1 overlays with all filled colors, overlay=2
overlays with SegyData2 as filled colors and SegyData1 as conotur. Default 0</p></li>
<li><p><strong>scale</strong> (<em>float</em><em>, </em><em>optional</em>) – value to scale the amplitude of the wiggles for visualisation only. Default 1</p></li>
<li><p><strong>skip_trace</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of traces to skip. Default 20.</p></li>
<li><p><strong>skip_time</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of time samples to skip. Default 0</p></li>
<li><p><strong>delay_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – number of time samples to delay the signal. Will pad the signal with 0s at the
beginning of each trace. Default 0.</p></li>
<li><p><strong>xstart</strong> (<em>int</em><em>, </em><em>optional</em>) – first receiver index to plot. Default 0.</p></li>
<li><p><strong>xend</strong> (<em>int</em><em>, </em><em>optional</em>) – last receiver index to plot. Default None</p></li>
<li><p><strong>wstart</strong> (<em>int</em><em>, </em><em>optional</em>) – first timesample in time units to plot. Default 0</p></li>
<li><p><strong>wend</strong> (<em>int</em><em>, </em><em>optional</em>) – last timesample in time units to plot. Default None</p></li>
<li><p><strong>label1</strong> (<em>str</em><em>, </em><em>optional</em>) – Label for SegyData1. Default SegyData1</p></li>
<li><p><strong>label2</strong> (<em>str</em><em>, </em><em>optional</em>) – Label for SegyData2. Default SegyData2</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>) – set to true in order to save the plot in png 300dpi. Default False</p></li>
<li><p><strong>save_path</strong> (<em>str</em><em>, </em><em>optional</em>) – path to save the plot. Default “./”</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="fullwaveqc.visual.vpmodel">
<code class="sig-prename descclassname">fullwaveqc.visual.</code><code class="sig-name descname">vpmodel</code><span class="sig-paren">(</span><em class="sig-param">Model</em>, <em class="sig-param">cap=0.0</em>, <em class="sig-param">levels=200</em>, <em class="sig-param">vmin=None</em>, <em class="sig-param">vmax=None</em>, <em class="sig-param">cmap=&lt;matplotlib.colors.LinearSegmentedColormap object&gt;</em>, <em class="sig-param">units='m/s'</em>, <em class="sig-param">save=False</em>, <em class="sig-param">save_path='./'</em><span class="sig-paren">)</span><a class="headerlink" href="#fullwaveqc.visual.vpmodel" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the P-velocity amplitude map of a Model object in depth and lateral offset.
Uses properties of matplotlib.contourf.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Model</strong> (<em>fullwavqc.tools.Model</em>) – object outputted from fullwaveqc.tools.load function for a model</p></li>
<li><p><strong>levels</strong> (<em>int</em><em>, </em><em>optional</em>) – amount of levels in the contour plot. See matplotlib.pyplot.contourf parameters. Default 200</p></li>
<li><p><strong>cap</strong> (<em>float</em><em>, </em><em>optional</em>) – absolute value of amplitudes to cap, shown as 0. Default 0.</p></li>
<li><p><strong>vmin</strong> (<em>float</em><em>, </em><em>optional</em>) – min val of color plot scale. See matplotlib.pyplot.contourf parameters. Default None.</p></li>
<li><p><strong>vmax</strong> (<em>float</em><em>, </em><em>optional</em>) – max val of color plot scale. See matplotlib.pyplot.contourf parameters. Default None.</p></li>
<li><p><strong>cmap</strong> (<em>matplotlib.pyplot.cm</em>) – colormap. Default plt.cm.jet</p></li>
<li><p><strong>units</strong> (<em>str</em><em>, </em><em>optional</em>) – units of amplitudes to show in colorbar. Default m/s</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>) – set to true in order to save the plot in png 300dpi. Default False</p></li>
<li><p><strong>save_path</strong> (<em>str</em><em>, </em><em>optional</em>) – path to save the plot. Default “./”</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="fullwaveqc.visual.vpwell">
<code class="sig-prename descclassname">fullwaveqc.visual.</code><code class="sig-name descname">vpwell</code><span class="sig-paren">(</span><em class="sig-param">Model</em>, <em class="sig-param">pos_x</em>, <em class="sig-param">TrueModel=None</em>, <em class="sig-param">plot=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fullwaveqc.visual.vpwell" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the Vp well profile from a Model at specified locations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Model</strong> (<em>fullwaveqc.SegyData.Model</em>) – object outputted from fullwaveqc.tools.load function for a model</p></li>
<li><p><strong>pos_x</strong> (<em>list</em><em>(</em><em>ints</em><em>)</em>) – lateral distances to which retrieve the well data</p></li>
<li><p><strong>TrueModel</strong> (<em>fullwaveqc.SegyData.Model</em><em>, </em><em>optional</em>) – object outputted from fullwaveqc.tools.load function for the true model. Default None</p></li>
<li><p><strong>plot</strong> (<em>bool</em><em>, </em><em>optional</em>) – Plots the profiles when set to true.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>wells</strong> (<em>list[numpy.array]</em>) – Well values with depth</p></li>
<li><p><strong>true_wells</strong> (<em>list[numpy.array]</em>) – Only if TrueModel is given. True well values with depth</p></li>
<li><p><strong>rmses</strong> (<em>list[numpy.array]</em>) – Only if TrueModel is given. RMS errors between true well and predicted well values.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="fullwaveqc.visual.wiggle">
<code class="sig-prename descclassname">fullwaveqc.visual.</code><code class="sig-name descname">wiggle</code><span class="sig-paren">(</span><em class="sig-param">SegyData</em>, <em class="sig-param">shot=1</em>, <em class="sig-param">scale=5</em>, <em class="sig-param">skip_trace=20</em>, <em class="sig-param">skip_time=0</em>, <em class="sig-param">wstart=0.0</em>, <em class="sig-param">wend=None</em>, <em class="sig-param">xstart=0</em>, <em class="sig-param">xend=None</em>, <em class="sig-param">delay_samples=0</em>, <em class="sig-param">save=False</em>, <em class="sig-param">save_path='./'</em><span class="sig-paren">)</span><a class="headerlink" href="#fullwaveqc.visual.wiggle" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the wiggle trace map of a SegyData object in timesamples vs receiver index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>SegyData</strong> (<a class="reference internal" href="#fullwaveqc.tools.SegyData" title="fullwaveqc.tools.SegyData"><em>fullwaveqc.tools.SegyData</em></a>) – object outputted from fullwaveqc.tools.load function for the segy data</p></li>
<li><p><strong>shot</strong> (<em>int</em><em>, </em><em>optional</em>) – shot number to visualise SegyData1. Count starts from 1. Default 1</p></li>
<li><p><strong>scale</strong> (<em>float</em><em>, </em><em>optional</em>) – value to scale the amplitude of the wiggles for visualisation only. Default 1</p></li>
<li><p><strong>skip_trace</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of traces to skip. Default 20.</p></li>
<li><p><strong>skip_time</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of time samples to skip. Default 0</p></li>
<li><p><strong>xstart</strong> (<em>int</em><em>, </em><em>optional</em>) – first receiver index to plot. Default 0.</p></li>
<li><p><strong>xend</strong> (<em>int</em><em>, </em><em>optional</em>) – last receiver index to plot. Default None</p></li>
<li><p><strong>wstart</strong> (<em>int</em><em>, </em><em>optional</em>) – first timesample in time units to plot. Default 0</p></li>
<li><p><strong>wend</strong> (<em>int</em><em>, </em><em>optional</em>) – last timesample in time units to plot. Default None</p></li>
<li><p><strong>delay_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – number of time samples to delay the signal. Will pad the signal with 0s at the
beginning of each trace. Default 0.</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>) – set to true in order to save the plot in png 300dpi. Default False</p></li>
<li><p><strong>save_path</strong> (<em>str</em><em>, </em><em>optional</em>) – path to save the plot. Default “./”</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-fullwaveqc.siganalysis"></span><dl class="function">
<dt id="fullwaveqc.siganalysis.closest2pow">
<code class="sig-prename descclassname">fullwaveqc.siganalysis.</code><code class="sig-name descname">closest2pow</code><span class="sig-paren">(</span><em class="sig-param">n</em><span class="sig-paren">)</span><a class="headerlink" href="#fullwaveqc.siganalysis.closest2pow" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the first integer greater or equal to n that is a power of 2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>n</strong> (<em>float</em>) – any positive number</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>n2pow</strong> – the first integer greater or equal to n that is an exact power of two</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError if n is less</strong><strong> or </strong><strong>equal to zero</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="fullwaveqc.siganalysis.dataspec">
<code class="sig-prename descclassname">fullwaveqc.siganalysis.</code><code class="sig-name descname">dataspec</code><span class="sig-paren">(</span><em class="sig-param">SegyData</em>, <em class="sig-param">ms=True</em>, <em class="sig-param">shot=1</em>, <em class="sig-param">fmax=None</em>, <em class="sig-param">fft_smooth=3</em>, <em class="sig-param">plot=False</em><span class="sig-paren">)</span><a class="headerlink" href="#fullwaveqc.siganalysis.dataspec" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns and plots the frequency spectrum of a single shot of a dataset. Does so by stacking the frequencies of each
individual trace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>SegyData</strong> (<a class="reference internal" href="#fullwaveqc.tools.SegyData" title="fullwaveqc.tools.SegyData"><em>fullwaveqc.tools.SegyData</em></a>) – object outputted from fullwaveqc.tools.load function containing the dataset</p></li>
<li><p><strong>ms</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set to true if sampling rate in Wavelet object is in miliseconds, otherwise assumed
in seconds. Default: True</p></li>
<li><p><strong>shot</strong> (<em>int</em><em>, </em><em>optional</em>) – Shot number to compute the frequency spectrum. Default 1</p></li>
<li><p><strong>fmax</strong> (<em>float</em><em>, </em><em>optional</em>) – Value of the highest frequency expected in the signal. Default: None</p></li>
<li><p><strong>plot</strong> (<em>bool</em><em>, </em><em>optional</em>) – Will plot the wavelet in time and wave frequencies if set to True. Default: False</p></li>
<li><p><strong>fft_smooth</strong> (<em>int</em><em>, </em><em>optional</em>) – Parameter used to multiply the number of samples inputted into the Fast Fourier
Transform. Increase this factor for a smoother plot. The final number of sample
points will be the nearest power of two of fft_smooth multiplied by the original
number of time samples in the signal. Higher value increases computational time.
Default: 3</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>xf</strong> (<em>numpy.array</em>) – 1D array containing the frequencies</p></li>
<li><p><strong>yf</strong> (<em>numpy.array</em>) – 1D array containing the power of the frequencies in dB</p></li>
<li><p><strong>phase</strong> (<em>numpy.array</em>) – 1D array containing the unwrapped phases at each frequency</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="fullwaveqc.siganalysis.gausswindow">
<code class="sig-prename descclassname">fullwaveqc.siganalysis.</code><code class="sig-name descname">gausswindow</code><span class="sig-paren">(</span><em class="sig-param">samples</em>, <em class="sig-param">wstart</em>, <em class="sig-param">wend</em>, <em class="sig-param">dt</em><span class="sig-paren">)</span><a class="headerlink" href="#fullwaveqc.siganalysis.gausswindow" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a gaussian function to window a signal. Standard deviation of the gaussian function is equivalent to one
quarter the window width</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>int</em>) – Total of points in the function</p></li>
<li><p><strong>wstart</strong> (<em>int</em>) – Start time of the window (ms)</p></li>
<li><p><strong>wend</strong> (<em>int</em>) – End time of the window (ms)</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – Time sampling of the signal(ms)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>w</strong> – 1D array of a gaussian window of size (samples, 1)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="fullwaveqc.siganalysis.phasediff">
<code class="sig-prename descclassname">fullwaveqc.siganalysis.</code><code class="sig-name descname">phasediff</code><span class="sig-paren">(</span><em class="sig-param">PredData</em>, <em class="sig-param">ObsData</em>, <em class="sig-param">f=1</em>, <em class="sig-param">wstart=200</em>, <em class="sig-param">wend=1000</em>, <em class="sig-param">nr_min=0</em>, <em class="sig-param">nr_max=None</em>, <em class="sig-param">ns_min=0</em>, <em class="sig-param">ns_max=None</em>, <em class="sig-param">ms=True</em>, <em class="sig-param">fft_smooth=3</em>, <em class="sig-param">unwrap=True</em>, <em class="sig-param">plot=False</em>, <em class="sig-param">verbose=1</em><span class="sig-paren">)</span><a class="headerlink" href="#fullwaveqc.siganalysis.phasediff" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes and plots the phase difference between an observed and predicted dataset, at a single specified frequency,
for all receivers and shots. Will present undesired unwrapping effects in the presence of noise or low-amplitude
signal. Calculates phase_observed - phase_predicted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>PredData</strong> (<a class="reference internal" href="#fullwaveqc.tools.SegyData" title="fullwaveqc.tools.SegyData"><em>fullwaveqc.tools.SegyData</em></a>) – object outputted from fullwaveqc.tools.load function</p></li>
<li><p><strong>ObsData</strong> (<a class="reference internal" href="#fullwaveqc.tools.SegyData" title="fullwaveqc.tools.SegyData"><em>fullwaveqc.tools.SegyData</em></a>) – object outputted from fullwaveqc.tools.load function. Should have the same time sampling as PredData</p></li>
<li><p><strong>f</strong> (<em>float</em><em>, </em><em>optional</em>) – Frequency in Hz at which the phase difference should be calculated. Default: 1</p></li>
<li><p><strong>wstart</strong> (<em>int</em><em>, </em><em>optional</em>) – Time sample to which start the window for the phase difference computation. Default: 200</p></li>
<li><p><strong>wend</strong> (<em>int</em><em>, </em><em>optional</em>) – Time sample to which end the window for the phase difference computation.If negative will take the entire
shot window. Default: 1000</p></li>
<li><p><strong>nr_min</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum receiver index to which calculate the phase difference. Default 0.</p></li>
<li><p><strong>nr_max</strong> (<em>int</em><em>, </em><em>optional</em>) – <dl class="simple">
<dt>Maximum  receiver index to which calculate the phase difference. If None is given, then number of receivers</dt><dd><p>is inferred from the datasets. Default None.</p>
</dd>
</dl>
</p></li>
<li><p><strong>ns_min</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum source/shot index to which calculate the phase difference. Default: 0</p></li>
<li><p><strong>ns_max</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum source/shot index to which calculate the phase difference. If None is
given then number of sources is inferred from the datasets. Default: None</p></li>
<li><p><strong>ms</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set to true if sampling rate in Wavelet object is in miliseconds, otherwise assumed
in seconds. Default: True</p></li>
<li><p><strong>fft_smooth</strong> (<em>int</em><em>, </em><em>optional</em>) – Parameter used to multiply the number of samples inputted into the Fast Fourier
Transform. Increase this factor for a smoother plot. The final number of sample
points will be the nearest power of two of fft_smooth multiplied by the original
number of time samples in the signal. Higher value increases computational time.
Default: 3</p></li>
<li><p><strong>unwrap</strong> (<em>bool</em><em>, </em><em>optional</em>) – If set to true will perform phase unwrapping in the receiver domain. For a detailed
discussion of how these might affect the phase difference results, refer to the
project report in the Github repository. Default True</p></li>
<li><p><strong>plot</strong> (<em>bool</em><em>, </em><em>optional</em>) – Will plot the phase difference if set to True. Default: False</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – If set to True will verbose the main steps of the function calculation. Default True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>phase_pred</strong> (<em>numpy.array</em>) – 2D array of size (ns_max, nr_max) with the unwrapped phases of the
predicted dataset at the specified frequency</p></li>
<li><p><strong>phase_obs</strong> (<em>numpy.array</em>) – 2D array of size (ns_max, nr_max) with the unwrapped phases of the
observed dataset at the specified frequency</p></li>
<li><p><strong>phase_diff</strong> (<em>numpy.array</em>) – phase_diff  2D array of size (ns_max-ns_min, nr_max-nrmin) with the unwrapped phase differences
between the observed and predicted datasets at the specified frequency</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="fullwaveqc.siganalysis.wavespec">
<code class="sig-prename descclassname">fullwaveqc.siganalysis.</code><code class="sig-name descname">wavespec</code><span class="sig-paren">(</span><em class="sig-param">Wavelet</em>, <em class="sig-param">ms=True</em>, <em class="sig-param">fmax=None</em>, <em class="sig-param">plot=False</em>, <em class="sig-param">fft_smooth=3</em><span class="sig-paren">)</span><a class="headerlink" href="#fullwaveqc.siganalysis.wavespec" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns and plots the frequency spectrum of a source wavelet.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Wavelet</strong> (<a class="reference internal" href="#fullwaveqc.tools.SegyData" title="fullwaveqc.tools.SegyData"><em>fullwaveqc.tools.SegyData</em></a>) – object outputted from fullwaveqc.tools.load function with the wavelet data</p></li>
<li><p><strong>ms</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set to true if sampling rate in Wavelet object is in miliseconds, otherwise assumed
in seconds. Default: True</p></li>
<li><p><strong>fmax</strong> (<em>float</em><em>, </em><em>optional</em>) – Value of the highest frequency expected in the signal. Default: None</p></li>
<li><p><strong>plot</strong> (<em>bool</em><em>, </em><em>optional</em>) – Will plot the wavelet in time and wave frequencies if set to True. Default: False</p></li>
<li><p><strong>fft_smooth</strong> (<em>int</em><em>, </em><em>optional</em>) – Parameter used to multiply the number of samples inputted into the Fast Fourier
Transform. Increase this factor for a smoother plot. The final number of sample
points will be the nearest power of two of fft_smooth multiplied by the original
number of time samples in the signal. Higher value increases computational time.
Default: 3</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>xf</strong> (<em>numpy.array</em>) – 1D array containing the frequencies</p></li>
<li><p><strong>yf</strong> (<em>numpy.array</em>) – 1D array containing the power of the frequencies in dB</p></li>
<li><p><strong>phase</strong> (<em>numpy.array</em>) – 1D array containing the unwrapped phases at each frequency</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="fullwaveqc.siganalysis.xcorr">
<code class="sig-prename descclassname">fullwaveqc.siganalysis.</code><code class="sig-name descname">xcorr</code><span class="sig-paren">(</span><em class="sig-param">PredData</em>, <em class="sig-param">ObsData</em>, <em class="sig-param">wstart=0</em>, <em class="sig-param">wend=-1</em>, <em class="sig-param">nr_min=0</em>, <em class="sig-param">nr_max=None</em>, <em class="sig-param">ns_min=0</em>, <em class="sig-param">ns_max=None</em>, <em class="sig-param">ms=True</em>, <em class="sig-param">plot=False</em>, <em class="sig-param">verbose=1</em><span class="sig-paren">)</span><a class="headerlink" href="#fullwaveqc.siganalysis.xcorr" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes and plots the cross-correlation between an observed and predicted dataset using numpy.correlate.
Traces are normalised to unit length for comparison</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>PredData</strong> (<a class="reference internal" href="#fullwaveqc.tools.SegyData" title="fullwaveqc.tools.SegyData"><em>fullwaveqc.tools.SegyData</em></a>) – object outputted from fullwaveqc.tools.load function</p></li>
<li><p><strong>ObsData</strong> (<a class="reference internal" href="#fullwaveqc.tools.SegyData" title="fullwaveqc.tools.SegyData"><em>fullwaveqc.tools.SegyData</em></a>) – object outputted from fullwaveqc.tools.load function</p></li>
<li><p><strong>wstart</strong> (<em>int</em><em>, </em><em>optional</em>) – Time sample to which start the window for the phase difference computation. Default: 0</p></li>
<li><p><strong>wend</strong> (<em>int</em><em>, </em><em>optional</em>) – Time sample to which end the window for the phase difference computation.If negative will use the entire shot
window. Default -1.</p></li>
<li><p><strong>nr_min</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum receiver index to which calculate the phase difference. Default 0.</p></li>
<li><p><strong>nr_max</strong> (<em>int</em><em>, </em><em>optional</em>) – <dl class="simple">
<dt>Maximum  receiver index to which calculate the phase difference. If None is given, then number of receivers</dt><dd><p>is inferred from the datasets. Default None.</p>
</dd>
</dl>
</p></li>
<li><p><strong>ns_min</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum source/shot index to which calculate the phase difference. Default: 0</p></li>
<li><p><strong>ns_max</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum source/shot index to which calculate the phase difference. If None is
given then number of sources is inferred from the datasets. Default: None</p></li>
<li><p><strong>ms</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set to true if sampling rate in Wavelet object is in miliseconds, otherwise assumed
in seconds. Default: True</p></li>
<li><p><strong>plot</strong> (<em>bool</em><em>, </em><em>optional</em>) – Will plot the phase difference if set to True. Default: False</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – If set to True will verbose the main steps of the function calculation. Default True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>xcorr_arr</strong> – 2D array of size (ns_max, nr_max) with the normalised cross correlation values</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-fullwaveqc.inversion"></span><dl class="function">
<dt id="fullwaveqc.inversion.functional">
<code class="sig-prename descclassname">fullwaveqc.inversion.</code><code class="sig-name descname">functional</code><span class="sig-paren">(</span><em class="sig-param">filepath</em>, <em class="sig-param">name=None</em>, <em class="sig-param">plot=False</em><span class="sig-paren">)</span><a class="headerlink" href="#fullwaveqc.inversion.functional" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves and plots the global functional value of an inversion run with Fullwave3D as recorded in the job log
file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> (<em>str</em>) – path to &lt;PROJECT_NAME&gt;_job,log file</p></li>
<li><p><strong>name</strong> (<em>str</em>) – name of the project. If not given, will be inferred from filename. Default: None</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) – if true will produce a plot of the functional values vs iterations. Default: False</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>iter_all</strong> (<em>numpy.array</em>) – array of iteration numbers of the run of size (number_of_iterations, 1)</p></li>
<li><p><strong>func</strong> (<em>numpy.array</em>) – array of functional of size (number_of_iterations, 1)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="fullwaveqc.inversion.steplen">
<code class="sig-prename descclassname">fullwaveqc.inversion.</code><code class="sig-name descname">steplen</code><span class="sig-paren">(</span><em class="sig-param">filepath</em>, <em class="sig-param">name=None</em>, <em class="sig-param">plot=False</em><span class="sig-paren">)</span><a class="headerlink" href="#fullwaveqc.inversion.steplen" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves and plots the global functional value of an inversion run with Fullwave3D as recorded in the job log
file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> (<em>str</em>) – path to &lt;PROJECT_NAME&gt;_job,log file</p></li>
<li><p><strong>name</strong> (<em>str</em>) – name of the project. If not given, will be inferred from filename. Default: None</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) – if true will produce a plot of the step length values vs iterations. And highlight
in red all negative step length values. Default: False</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>iter_all</strong> (<em>numpy.array</em>) – array of iteration numbers of the run of size (number_of_iterations, 1)</p></li>
<li><p><strong>func</strong> (<em>numpy.array</em>) – array of step length values of size (number_of_iterations, 1)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<div class="toctree-wrapper compound">
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="#">FullwaveQC</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Deborah Pelacani Cruz.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>